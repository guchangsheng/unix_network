<?phprequire_once 'Http.php';$port = 6666;$sock = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);socket_set_option($sock, SOL_SOCKET, SO_REUSEADDR, 1);//绑定所有进入该端口的连接socket_bind($sock, 0, $port);socket_listen($sock);register_signal(SIGCHLD);$pids = [];while (1){    pcntl_signal_dispatch();    $newsock = socket_accept($sock);    $status = "HTTP/1.0 200 OK\r\n";    $header = "Server: DWBServer\r\nContent-Type: text/html;charset=utf-8\r\n\r\n";    $body   = "<html><head><title>Web服务器</title></head><body><h2>欢迎</h2><p>Hello，World</p></body></html>";    $pid = pcntl_fork();    if($pid == 0)    {        $data = @socket_read($newsock, 1024);        $data = http::decode($data);        #var_dump($data);        socket_write($newsock, $status.$header.$body);        socket_close($newsock);        exit(0);    }elseif($pid>0){        array_push($pids,$pid);    }else{        exit(255);    }    sleep(1);}socket_close($sock);function register_signal($sig){    pcntl_signal($sig,"signal_handle");}function signal_handle($sig){    if($sig==SIGCHLD){        global $pids;        foreach ($pids as $pid )        {            $res = pcntl_waitpid($pid,$status, WNOHANG);            if($res == -1 || $res > 0){                $key = array_search($pid,$pids);                unset($pids[$key]);            }        }    }}